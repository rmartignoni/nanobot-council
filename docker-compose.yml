x-nanobot: &nanobot-base
  build:
    context: .
    dockerfile: Dockerfile
  command: ["gateway"]
  restart: unless-stopped
  deploy:
    resources:
      limits:
        cpus: '1'
        memory: 1G
      reservations:
        cpus: '0.25'
        memory: 256M

services:
  alice:
    <<: *nanobot-base
    container_name: nanobot-alice
    volumes:
      - ./nano_config/alice:/root/.nanobot
    ports:
      - "18791:18790"

  bob:
    <<: *nanobot-base
    container_name: nanobot-bob
    volumes:
      - ./nano_config/bob:/root/.nanobot
    ports:
      - "18792:18790"
